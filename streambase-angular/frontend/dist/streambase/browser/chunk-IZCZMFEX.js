import{d as L,i as W}from"./chunk-SEKZDLHL.js";import"./chunk-IKQRC3XM.js";import{d as H,k as w,l as G}from"./chunk-7FPOL3XV.js";import{u as E,v as I,w as D}from"./chunk-IMHAIZ3T.js";import{oa as k}from"./chunk-VFXDPC4I.js";import{Db as T,Ec as M,Hb as a,Ib as d,Jb as p,Kb as b,Lb as S,Nb as y,Qb as V,Sb as m,Uc as U,Vc as P,Yc as F,a as t,b as o,bc as h,cb as l,ia as v,jc as O,ma as _,nb as c,ua as f,ub as g,va as C,yb as r,zb as x}from"./chunk-EDYQIVRR.js";function z(n,i){if(n&1&&(a(0,"div",4),p(1,"div",5),a(2,"div",6)(3,"h1"),h(4,"Welcome to Streambase"),d(),a(5,"p"),h(6,"Discover your next favorite movie or TV show"),d()()()),n&2){let e=m();x("background-image","url(https://image.tmdb.org/t/p/original/"+(e.trendingMovies()[e.count()].backdrop_path||"")+")")}}function A(n,i){if(n&1&&p(0,"app-movie-slider",10),n&2){let e=m(2);r("movies",e.trendingMovies())("title","Trending Movies")}}function B(n,i){if(n&1&&p(0,"app-movie-slider",10),n&2){let e=m(2);r("movies",e.trendingTV())("title","Trending TV Shows")}}function R(n,i){if(n&1&&p(0,"app-movie-slider",10),n&2){let e=m(2);r("movies",e.upcoming())("title","Upcoming Movies")}}function $(n,i){if(n&1&&p(0,"app-movie-slider",10),n&2){let e=m(2);r("movies",e.similarMovies())("title","Because you watched "+e.userWatched().title)}}function K(n,i){if(n&1&&p(0,"app-movie-slider",10),n&2){let e=m().$implicit,s=m(2);r("movies",s.genreMovies[e.id].movies)("title",e.name)}}function q(n,i){if(n&1){let e=y();b(0),a(1,"div",11),V("onVisible",function(){let u=f(e).$implicit,j=m(2);return C(j.loadGenreMovies(u.id))}),g(2,K,1,2,"app-movie-slider",8),d(),S()}if(n&2){let e=i.$implicit,s=m(2);l(2),r("ngIf",!s.genreMovies[e.id].loading&&!s.genreMovies[e.id].error&&s.genreMovies[e.id].movies.length>0)}}function J(n,i){if(n&1&&(a(0,"div",2)(1,"div",7),g(2,A,1,2,"app-movie-slider",8),d(),a(3,"div",7),g(4,B,1,2,"app-movie-slider",8),d(),a(5,"div",7),g(6,R,1,2,"app-movie-slider",8),d(),a(7,"div",7),g(8,$,1,2,"app-movie-slider",8),d(),g(9,q,3,1,"ng-container",9),d()),n&2){let e=m();l(2),r("ngIf",!e.loading().trendingMovies&&!e.error().trendingMovies&&e.trendingMovies().length>0),l(2),r("ngIf",!e.loading().trendingTV&&!e.error().trendingTV&&e.trendingTV().length>0),l(2),r("ngIf",!e.loading().upcoming&&!e.error().upcoming&&e.upcoming().length>0),l(2),r("ngIf",!e.loading().similarMovies&&!e.error().similarMovies&&e.similarMovies().length>0),l(),r("ngForOf",e.genres)}}function Q(n,i){n&1&&(a(0,"div",3),p(1,"mat-progress-spinner",12),d())}var N=class n{movieService=v(w);userService=v(G);router=v(H);userWatched=M(()=>this.userService.userWatched());count=c(0);trendingMovies=c([]);trendingTV=c([]);upcoming=c([]);similarMovies=c([]);genreMovies={};loading=c({trendingMovies:!0,trendingTV:!0,upcoming:!0,similarMovies:!0});error=c({trendingMovies:"",trendingTV:"",upcoming:"",similarMovies:""});isLoading=M(()=>{let i=this.loading(),e=i.trendingMovies||i.trendingTV||i.upcoming||i.similarMovies,s=Object.values(this.genreMovies).some(u=>u);return e||s});genres=[{id:28,name:"Action Packed"},{id:12,name:"Ready for Adventure?"},{id:53,name:"Spine Thrillers"},{id:35,name:"Comedy - Laugh Out Loud"},{id:16,name:"Kids corner"},{id:9648,name:"Unravelling Mystery"},{id:18,name:"Drama Hits"},{id:10751,name:"Family Favourites"},{id:10752,name:"At War"},{id:80,name:"Crime Busters"},{id:14,name:"Fantasy Adventures"},{id:27,name:"Horror Films"},{id:878,name:"Science Fiction"},{id:10749,name:"Romantic Movies"},{id:99,name:"Documentaries"}];ngOnInit(){this.genres.forEach(i=>{this.genreMovies[i.id]={movies:[],loading:!1,error:""}}),this.loadTrendingMovies(),setInterval(()=>{this.count.update(i=>i===19?0:i+1)},1e4)}loadTrendingMovies(){this.loading.update(i=>o(t({},i),{trendingMovies:!0})),this.error.update(i=>o(t({},i),{trendingMovies:""})),this.movieService.fetchTrendingMovies().subscribe({next:i=>{this.trendingMovies.set(i),this.loading.update(e=>o(t({},e),{trendingMovies:!1})),this.loadTrendingTV()},error:i=>{this.error.update(e=>o(t({},e),{trendingMovies:"Failed to load trending movies"})),this.loading.update(e=>o(t({},e),{trendingMovies:!1})),this.loadTrendingTV()}})}loadTrendingTV(){this.loading.update(i=>o(t({},i),{trendingTV:!0})),this.error.update(i=>o(t({},i),{trendingTV:""})),this.movieService.fetchTrendingTV().subscribe({next:i=>{this.trendingTV.set(i),this.loading.update(e=>o(t({},e),{trendingTV:!1})),this.loadUpcoming()},error:i=>{this.error.update(e=>o(t({},e),{trendingTV:"Failed to load trending TV"})),this.loading.update(e=>o(t({},e),{trendingTV:!1})),this.loadUpcoming()}})}loadUpcoming(){this.loading.update(i=>o(t({},i),{upcoming:!0})),this.error.update(i=>o(t({},i),{upcoming:""})),this.movieService.fetchUpcoming().subscribe({next:i=>{this.upcoming.set(i),this.loading.update(e=>o(t({},e),{upcoming:!1})),this.loadSimilarMovies()},error:i=>{this.error.update(e=>o(t({},e),{upcoming:"Failed to load upcoming movies"})),this.loading.update(e=>o(t({},e),{upcoming:!1})),this.loadSimilarMovies()}})}loadSimilarMovies(){this.loading.update(i=>o(t({},i),{similarMovies:!0})),this.error.update(i=>o(t({},i),{similarMovies:""})),this.movieService.fetchSimilarMovies(this.userWatched().id.toString()).subscribe({next:i=>{this.similarMovies.set(i),this.loading.update(e=>o(t({},e),{similarMovies:!1}));for(let e of this.genres)this.loadGenreMovies(e.id)},error:i=>{this.error.update(e=>o(t({},e),{similarMovies:"Failed to load similar movies"})),this.loading.update(e=>o(t({},e),{similarMovies:!1}));for(let e of this.genres)this.loadGenreMovies(e.id)}})}loadGenreMovies(i){this.genreMovies[i].loading||this.genreMovies[i].movies.length>0||(this.genreMovies[i].loading=!0,this.genreMovies[i].error="",this.movieService.fetchMoviesByGenre(i).subscribe({next:e=>{this.genreMovies[i].movies=e,this.genreMovies[i].loading=!1},error:e=>{this.genreMovies[i].error=`Failed to load ${this.getGenreName(i)} movies`,this.genreMovies[i].loading=!1}}))}getGenreName(i){return this.genres.find(e=>e.id===i)?.name||"Unknown"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=_({type:n,selectors:[["app-user-home"]],standalone:!0,features:[O],decls:4,vars:2,consts:[[1,"home-container"],["class","hero-section",3,"backgroundImage",4,"ngIf"],[1,"content-container"],[1,"loading-container"],[1,"hero-section"],[1,"hero-overlay"],[1,"hero-content"],[1,"section"],[3,"movies","title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"movies","title"],[1,"section",3,"onVisible"],["diameter","40","mode","indeterminate"]],template:function(e,s){e&1&&(a(0,"div",0),g(1,z,7,2,"div",1)(2,J,10,5,"div",2)(3,Q,2,0,"div",3),d()),e&2&&(l(),r("ngIf",s.trendingMovies().length>0),l(),T(s.isLoading()?2:3))},dependencies:[F,U,P,E,k,L,D,I,W],styles:[".home-container[_ngcontent-%COMP%]{width:100%;min-height:100vh;background-color:inherit}.hero-section[_ngcontent-%COMP%]{height:70vh;position:relative;background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:background-image 3s ease-in-out,background-color 3s ease-in-out}.hero-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(to bottom,#000000b3,#00000080,#000000e6)}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:1;color:#fff;text-align:center}.hero-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.hero-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5rem;opacity:.8}.content-container[_ngcontent-%COMP%]{padding:2rem}.section[_ngcontent-%COMP%]{margin-bottom:3rem}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:2rem}.error-message[_ngcontent-%COMP%]{text-align:center;color:#f44336;padding:1rem}.error-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1rem}"]})};export{N as UserHomeComponent};
